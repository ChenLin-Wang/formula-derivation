# 随机生成一条与椭圆相交于一点线段公式推导

----------------

随机生成一条线段 p1p2，使此线段于椭圆 e 只有一个交点 p.

<img src="./images/Screen Shot 2020-10-06 at 10.52.58 AM.png" alt="Screen Shot 2020-10-06 at 10.52.58 AM" style="zoom:40%;" />

已知椭圆 e 的方程：
$$
\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1
$$
若此时有点 p(x1, y1)：
$$
\text{若 }\frac{x_1^2}{a^2} + \frac{y_1^2}{b^2} = 1 \text{说明点 p 在 椭圆 e 上} \\
\text{若 }\frac{x_1^2}{a^2} + \frac{y_1^2}{b^2} < 1 \text{说明点 p 在 椭圆 e 内} \\
\text{若 }\frac{x_1^2}{a^2} + \frac{y_1^2}{b^2} > 1 \text{说明点 p 在 椭圆 e 外} \\
$$
要随机一个一定与椭圆 e 只有一个交点的线段 L，就必须保证一点在 e 内，一点在外(忽略相切的情况)。或一点在椭圆上，一点不在。

在此只需要保证起始点在内，结束点在外即可，不需要穷举所有情况

设 L 起始点为 p1(x1, y1), 结束点为 p2(x2, y2)

则有：
$$
\begin{eqnarray*}
\frac{x_1^2}{a^2} + \frac{y_1^2}{b^2} < 1 \tag{1}\\
\frac{x_2^2}{a^2} + \frac{y_2^2}{b^2} > 1 \tag{2}\\
\end{eqnarray*}
$$

------------------

<img src="./images/Screen Shot 2020-10-06 at 11.00.33 AM.png" alt="Screen Shot 2020-10-06 at 11.00.33 AM" style="zoom:33%;" />

推导（1）：
$$
\begin{align}
&& \frac{x_1^2}{a^2} + \frac{y_1^2}{b^2} &< 1\\
&& \frac{x_1^2}{a^2} &< 1 - \frac{y_1^2}{b^2}\\
&& x_1^2 &< a^2(1 - \frac{y_1^2}{b^2})\\
&& -\sqrt{| a^2(1 - \frac{y_1^2}{b^2})|} &< x_1 < \sqrt{|a^2(1 - \frac{y_1^2}{b^2})|}\\
&& 
\end{align}
$$
则 x1 的取值范围为：
$$
[-\sqrt{|a^2(1 - \frac{y_1^2}{b^2})|},\ \sqrt{|a^2(1 - \frac{y_1^2}{b^2})|}\ ]\\
$$
同理，y1 的取值范围为：
$$
[-\sqrt{|b^2(1 - \frac{x_1^2}{a^2})|},\ \sqrt{|b^2(1 - \frac{x_1^2}{a^2})|}\ ]\\
$$
暂时设 y1 = 0，则 x1 的取值范围为：
$$
[-a,\ a] \tag{1.1}
$$
在取值范围（1.1）中随机得出一个值作为 x1，则此时 x1 已知。

再将 x1 代入到 y1 的取值范围，则 y1 的取值范围也可知，在 y1 取值范围中 随机取值即可得到 y1

则 p1(x1, y1) 一定在 椭圆 e 中

---------------------

推导（2）得：
$$
\begin{align}
&& x_2^2 &> a^2(1 - \frac{y_2^2}{b^2})\\[10px]
&& -\sqrt{| a^2(1 - \frac{y_2^2}{b^2})|} &> x_2\\
&& \text{或} \\
&& \sqrt{|a^2(1 - \frac{y_2^2}{b^2})|} &< x_2
\end{align}
$$
x2 取值范围为：
$$
(-\infty,\ -\sqrt{| a^2(1 - \frac{y_2^2}{b^2})|}\ ] \cup [\sqrt{|a^2(1 - \frac{y_2^2}{b^2})|},\ +\infty)
$$
y2 取值范围为：
$$
(-\infty,\ -\sqrt{| b^2(1 - \frac{x_2^2}{a^2})|}\ ] \cup [\sqrt{|b^2(1 - \frac{x_2^2}{a^2})|},\ +\infty)
$$
同上，暂时设 y2 = 0，则 x1 的取值范围可知，随机取值后 x2 为已知值

再将 x2 代入到 y2 的取值范围中，则 y2 的取值范围也可知，在 y2 取值范围中随机取值后 y2 也为已知

则，p2(x2, y2) 一定在 椭圆 e 外